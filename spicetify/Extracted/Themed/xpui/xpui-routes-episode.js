"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[472],{99922:(e,i,n)=>{n.d(i,{o:()=>t});var a=n(17231),l=n(44503);function t(){return{version:(0,a.W6)(l.GE)?2:1}}},80651:(e,i,n)=>{n.r(i),n.d(i,{Episode:()=>Ue,default:()=>Ie,parseReleaseDate:()=>Ce});var a=n(67294),l=n.n(a),t=n(65858),d=n(61202),o=n(20657),s=n(69518),r=n.n(s),m=n(62975),c=n(67154),u=n.n(c),k=n(28248),v=n(76343),p=n(28120),S=n(38470),N=n(74600),y=n(54280);const g=({uri:e,segmentCount:i})=>{const n=(0,y.G)(),t=(0,a.useCallback)((async(i,a)=>{const l=Math.ceil(i/2);try{return function(e,i,n){return e.reduce(((e,a,l)=>((l>0||i>0)&&e.push({type:"SPACER",id:`spacer-${e.length}`}),"MUSIC"===a.type?e.push(function(e,i,n){return{type:"MUSIC",index:i,uri:n.uri,episodeUri:e,start:n.start,stop:n.stop,duration:n.duration,name:n.track.name,artists:n.track.artists,album:n.track.album,playable:n.track.playable}}(n,l,a)):"TALK"===a.type&&e.push(function(e,i,n){return{type:"TALK",index:i,uri:e,title:n.title,subtitle:n.subtitle,start:n.start,stop:n.stop,duration:n.duration,showUri:n.show.uri,showName:n.show.name}}(n,l,a)),e)),[])}(await n.getSegments(e,l,a),l,e)}catch(e){return[]}}),[n,e]),d=(0,a.useCallback)((i=>{switch(i.type){case"SPACER":return l().createElement("div",{key:i.id,className:p.Z.spacerRow});case"MUSIC":return l().createElement(k.Z,u()({key:`${e}-${i.index}`},i));case"TALK":return l().createElement(N.t,u()({key:`${e}-${i.index}`},i));default:return(0,S.U)(i)}}),[e]),s=o.ag.get("music_and_talk.in_this_episode");return l().createElement("div",null,l().createElement(v.Dy,{as:"h2",variant:v.$e.canon,color:"var(--spice-text)",className:p.Z.header},s),l().createElement(k.Pv,{ariaLabel:s,hasHeaderRow:!0,rowPlaceholder:k.hU,columns:[k.QD.TITLE,k.QD.ALBUM_OR_SHOW,k.QD.DURATION],renderRow:d,fetchTracks:t,resolveUri:e=>"MUSIC"===e.type?e.uri:"",limit:50,nrTracks:2*i-1,testID:"music-and-talk-tracklist"}))};var E=n(44503),h=n(1663),F=n(37483);const b="Ck11dU0ipD52SdUcCdl3",f="EzPp2M6sPnJCpwd8Jbi7",P="WL5zy4E6QItBeCT6BdYq",w="HXLKjt4pA15hJqLJxnWA",D="FdpyBxDdNrrL27wrINsy",U="QJPX1kGtuCNg6EUL2LAS";var I=n(92408),C=n(56802),A=n(42273),L=n(20238),T=n(7073),M=n(20246),R=n(25988),x=n(95661),_=n(43620),B=n(18261),z=n(99922),V=n(74849);const O=(0,a.lazy)((()=>n.e(396).then(n.bind(n,88396))));function W(e){const i=(0,V.m)(),n=(0,z.o)();return i?l().createElement(a.Suspense,{fallback:!0},l().createElement(O,u()({reason:"Episode page"},n,e))):null}var $=n(51871),K=n(11414),q=n(30947),X=n(17231),Y=n(67892),J=n(84242),Q=n(38894),Z=n(98984);const G={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getEpisode"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"htmlDescription"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"externallyHosted"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"audioPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"playedState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playPositionMilliseconds"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"trailer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}},{kind:"Field",name:{kind:"Name",value:"showTypes"}}]}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}}]}},{kind:"Field",name:{kind:"Name",value:"segments"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"segments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}}]}}]}}]}}]}}]};var H=n(94184),j=n.n(H),ee=n(63897);const ie="axX_dOb7KXxh2BhADfuQ",ne="DIz7crU76YDtXXLx34nF",ae="R2a58pDnuIWBldpbVPRr",le=({title:e,episodes:i,className:n})=>l().createElement("div",{className:j()(ie,n)},l().createElement(v.Dy,{as:"h2",variant:v.Dy.canon,className:ne},e),l().createElement("div",{className:ae},i.map((e=>l().createElement(ee.B,{key:e.id,entity:e}))))),te={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getRecommendedEpisodes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recommendedEpisodes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"episode"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}}]}}]}}]}}]}}]}}]}}]},de=({uri:e,limit:i})=>{var n;const{data:t}=(d={uri:e,limit:i},(0,Z.a)(te,d,s));var d,s;const r=(0,a.useMemo)((()=>{var e;return((null==t||null===(e=t.episode)||void 0===e?void 0:e.recommendedEpisodes.items)||[]).map((e=>{var i,n,a,l,t,d,o;return{id:e.episode.id,uri:e.episode.uri,name:e.episode.name,description:null!==(i=e.episode.description)&&void 0!==i?i:"",explicit:(null===(n=e.episode.contentRating)||void 0===n?void 0:n.label)===T.KS.Explicit,release_date:Ce(null===(a=e.episode.releaseDate)||void 0===a?void 0:a.isoString),duration_ms:e.episode.duration.totalMilliseconds,images:null!==(l=null===(t=e.episode.coverArt)||void 0===t?void 0:t.sources)&&void 0!==l?l:[],show:{images:null!==(d=null===(o=e.episode.podcast.coverArt)||void 0===o?void 0:o.sources)&&void 0!==d?d:[]}}}))}),[null==t||null===(n=t.episode)||void 0===n?void 0:n.recommendedEpisodes.items]);return(null==r?void 0:r.length)>0?l().createElement(le,{title:o.ag.get("mwp.entity.might.like"),episodes:r}):null};var oe=n(8341),se=n(62890),re=n(23716),me=n(5944),ce=n(30247),ue=n(70369),ke=n(34325),ve=n(57978),pe=n(84629),Se=n(84788),Ne=n(59482),ye=n(72907),ge=n(55911),Ee=n(46245),he=n(72917),Fe=n(95806),be=n(18061),fe=n(8247);const Pe="activation-trigger-mme",we=({episodeUri:e,showUri:i,isLocked:n,isPlaying:a,isPlayDisabled:d,playButtonPlayLabel:o,playButtonPauseLabel:s,onClick:m})=>{const c=(0,t.v9)((e=>{var i;return null===(i=e.platform)||void 0===i?void 0:i.isBrowser})),u=l().createElement(Fe.l,{showUri:i,enabled:n},l().createElement(be.F,{property:fe.iY,renderOldExperience:()=>l().createElement(ge.JM,{size:ge.qE.lg,onClick:m,isPlaying:a,disabled:d,locked:n,ariaPlayLabel:o,ariaPauseLabel:s}),renderNewExperience:()=>l().createElement(Ee.fh,{size:"lg",onClick:m,isPlaying:a,disabled:d,locked:n,ariaPlayLabel:o,ariaPauseLabel:s})}));return c?l().createElement(he.c,{id:Pe,targetURI:r().from(e)},u):u};function De(e){const i=r().from(e);return`/show/${r().hexToId((null==i?void 0:i.id)||"")}`}const Ue=e=>{var i,n,s,c,u,k,p,S,N,y,z,V,O,H,j;const{uri:ee}=e,ie=(0,d.TH)(),ne=(0,t.I0)(),ae=(0,re.g)(),le=(0,C.o)(),te=(0,X.W6)(E.Cz),{data:ge}=(Ee={uri:ee},he={cacheTime:30*Z.y},(0,Z.a)(G,Ee,he));var Ee,he;const Fe=null==ge?void 0:ge.episode,[be,fe]=(0,a.useState)((null==Fe?void 0:Fe.playedState.state)===T.sY.Completed),Ue=(0,X.W6)(E.Be),Ie=null==ge||null===(i=ge.episode)||void 0===i||null===(n=i.segments)||void 0===n||null===(s=n.segments)||void 0===s?void 0:s.totalCount,Ae=void 0!==Ie&&Ie>0&&Ue,Le=(0,Q.g)(),{triggerPlay:Te,togglePlay:Me,isPlaying:Re,isActive:xe}=(0,J.n)({uri:ee},{featureIdentifier:"episode"}),_e=(0,oe.Y)((e=>{var i;return null!==(i=(0,me.k)(e))&&void 0!==i?i:void 0})),Be=(0,oe.Y)((e=>{var i;return null!==(i=null==e?void 0:e.isPaused)&&void 0!==i?i:void 0})),ze=null==Fe?void 0:Fe.type,Ve=function(e,i,n,a,t){const d=i===T.Wf.Episode;return(0,ke.G3)(e,a,n,t)?l().createElement(ke.Fg,{isMusicAndTalk:d}):d?o.ag.get("type.showEpisode"):o.ag.get("type.podcastEpisode")}(ee,ze||T.Wf.Unknown,null!==(c=null==Fe?void 0:Fe.playedState.playPositionMilliseconds)&&void 0!==c?c:0,Ce(null==Fe||null===(u=Fe.releaseDate)||void 0===u?void 0:u.isoString),(null==Fe?void 0:Fe.playedState.state)===T.sY.Completed),Oe=null==Fe||null===(k=Fe.coverArt)||void 0===k||null===(p=k.sources)||void 0===p||null===(S=p[0])||void 0===S?void 0:S.url,We=(0,_.Z)(Oe||null),$e=(0,t.v9)((e=>{var i;return null===(i=e.platform)||void 0===i?void 0:i.isBrowser})),Ke=!(null!=Fe&&Fe.playability.playable)&&(null==Fe?void 0:Fe.playability.reason)===T.Ku.PaymentRequired,qe=(0,ce.s)(Fe,null==Fe?void 0:Fe.podcast),{badges:Xe}=(0,Se.r)({contentRating:null==Fe||null===(N=Fe.contentRating)||void 0===N?void 0:N.label}),Ye=(0,a.useCallback)((e=>{null!=Fe&&Fe.playability.playable||!Xe.nineteen||(e.stopPropagation(),ne((0,pe.RM)((null==Fe?void 0:Fe.uri)||"")))}),[null==Fe?void 0:Fe.uri,null==Fe?void 0:Fe.playability.playable,Xe.nineteen,ne]),Je=(0,a.useCallback)(((e,i=!0)=>{if(Ke||!Fe)return;let n="play";!Re||0!==e&&i||(n="pause"),le({intent:n,targetUri:ee,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),ze===T.Wf.Episode&&$e?m.y.set((()=>({triggerId:Pe,triggerAction:null}))):xe&&!i?Le?Be?ae.resume():ae.pause():Me():Le?qe({seekTo:e}):Te({seekTo:e})}),[Ke,Fe,Re,le,ee,ze,$e,xe,Le,Be,ae,Me,qe,Te]),Qe=(0,a.useCallback)((()=>{le({intent:"expand-description",type:"click"})}),[le]),Ze=(null==Fe?void 0:Fe.description)||te&&(null==Fe?void 0:Fe.htmlDescription);if((0,a.useEffect)((()=>{if(Fe){const e=new URLSearchParams(ie.search);if(e.has("t")){const i=e.get("t")||"0",n=1e3*parseInt(i,10);n<=Fe.duration.totalMilliseconds&&Je(n)}}}),[Fe]),!Fe)return l().createElement(h.h,{errorMessage:o.ag.get("error.not_found.title.podcast")});const Ge=!Ke&&!Fe.playability.playable,He=o.ag.get("tracklist.a11y.play",Fe.name,Fe.podcast.name),je=o.ag.get("tracklist.a11y.pause",Fe.name,Fe.podcast.name),ei=Fe.podcast.uri,ii=null===(y=r().from(ei))||void 0===y?void 0:y.toURLPath(!0);return l().createElement("section",{"data-testid":"episode",className:b},l().createElement(ue.$,null,o.ag.get("podcasts.episode.seo.title",{name:Fe.name,show:null!==(z=null===(V=Fe.podcast)||void 0===V?void 0:V.name)&&void 0!==z?z:""})),l().createElement(A.gF,{backgroundColor:We},l().createElement(Ne.W,null,l().createElement(ye.i,{text:Fe.name,dragUri:ee,dragLabel:Fe.name})),l().createElement("div",{className:U},l().createElement(B._,{menu:l().createElement(R.k,{uri:ee,sharingInfo:Fe.sharingInfo,showUri:ei,contextUri:ee,isPlayed:be,onMarkAsPlayed:fe})},l().createElement(A.Oe,{loading:"eager",name:Fe.name,images:(null===(O=Fe.coverArt)||void 0===O?void 0:O.sources)||[],placeholderType:"episode",shape:A.Kc.ROUNDED_CORNERS}))),l().createElement(A.sP,null,l().createElement(A.dy,{small:!0,uppercase:!0},Ve),l().createElement(B._,{menu:l().createElement(R.k,{uri:ee,sharingInfo:Fe.sharingInfo,showUri:ei,contextUri:ee,isPlayed:be,onMarkAsPlayed:fe})},l().createElement(A.xd,{dragUri:ee,dragLabel:Fe.name},l().createElement("span",{"data-testid":"episodeTitle"},Fe.name))),l().createElement(B._,{menu:l().createElement(R.k,{uri:ee,sharingInfo:Fe.sharingInfo,showUri:ei,contextUri:ee,isPlayed:be,onMarkAsPlayed:fe})},l().createElement(Y.Z,{to:De(ei)},l().createElement(A.dy,{large:!0,bold:!0},l().createElement("span",{"data-testid":"showTitle"},Fe.podcast.name)))))),l().createElement(q.o,{backgroundColor:We},l().createElement(q.F,null,Xe.nineteen&&l().createElement(ve.X,{className:D,size:16}),l().createElement(I.E,{size:I.$.LARGE,fullyPlayed:be,durationMs:Fe.duration.totalMilliseconds,releaseDate:Ce(null===(H=Fe.releaseDate)||void 0===H?void 0:H.isoString),resumePositionMs:null!==(j=Fe.playedState.playPositionMilliseconds)&&void 0!==j?j:0,isPlaying:Re,position:xe&&_e||void 0})),l().createElement(q.F,null,l().createElement("div",{onClick:Ye},l().createElement(we,{episodeUri:ee,showUri:ei,isLocked:Ke,onClick:()=>{var e;Je(null!==(e=Fe.playedState.playPositionMilliseconds)&&void 0!==e?e:0,!1)},isPlaying:Re,isPlayDisabled:Ge,playButtonPlayLabel:He,playButtonPauseLabel:je})),!Ke&&l().createElement(F.p,{uri:Fe.uri,showUri:ei}),l().createElement($.w,{uri:Fe.uri,size:K.q.md}),l().createElement(M.y,{menu:l().createElement(R.k,{uri:ee,sharingInfo:Fe.sharingInfo,showUri:ei,contextUri:ee,isPlayed:be,onMarkAsPlayed:fe})},l().createElement(x.z,{label:o.ag.get("more.label.context",Fe.name)})))),l().createElement("div",{className:"contentSpacing"},Ze&&l().createElement(l().Fragment,null,l().createElement(v.Dy,{as:"h2",variant:v.$e.canon,color:"var(--spice-text)",className:P},o.ag.get("episode.description-title")),l().createElement(L.o,{className:f,onTimeStampClick:Je,maxLines:4,onExpanded:Qe,content:(Fe.description||"").trim(),htmlContent:te&&Fe.htmlDescription?Fe.htmlDescription:void 0,LinkComponent:Y.Z,enableTimestamps:Fe.playability.playable})),Ae&&l().createElement(g,{segmentCount:Ie||0,uri:ee}),ii&&l().createElement(se.z,{version:"outlined",linkTo:ii,className:w},o.ag.get("episode.see_all_episodes")),l().createElement(W,e),l().createElement(de,{uri:ee,limit:6})))},Ie=l().memo((()=>{const{episodeId:e}=(0,d.UO)(),i=r().episodeURI(e).toURI();return l().createElement(a.Suspense,{fallback:null},l().createElement(Ue,{uri:i,key:i}))}));function Ce(e){return(null==e?void 0:e.replace(/T.*/,""))||""}}}]);
//# sourceMappingURL=xpui-routes-episode.js.map